---
import FormattedDate from "./FormattedDate.astro";
import TagBadge from "./TagBadge.astro";

interface Props {
    title: string;
    url: string;
    date: Date;
    tags?: string[];
    heroImage?: string;
}

const { title, url, date, tags = [], heroImage } = Astro.props;
---

<div
    class="relative rounded-2xl overflow-hidden bg-white dark:bg-black/40 border border-zinc-200 dark:border-zinc-800 shadow-sm hover:shadow-md transition-all duration-300 group h-full"
>
    {/* Layer 1: Image (Right Side) */}
    {
        heroImage && (
            <div class="absolute top-0 right-0 bottom-0 w-[70%] h-full z-0 transition-transform duration-700 group-hover:scale-105">
                <img src={heroImage} alt="" class="w-full h-full object-cover" />
            </div>
        )
    }

    {
        /* Layer 2: Gradient Overlay (The Smooth Fade) 
        Use a pseudo-element style div to create the fade from solid card-bg to transparent
    */
    }
    <div
        class="absolute inset-0 z-0 pointer-events-none"
        style="background: linear-gradient(to right, var(--card-bg, theme('colors.white')) 0%, var(--card-bg, theme('colors.white')) 45%, transparent 100%);"
    >
        {
            /* Dark mode override using a separate div or just CSS variables. 
            Tailwind doesn't easily support dynamic gradient stops with dark mode classes in one line 
            without custom vars, so we use two divs or helper classes.
            Actually, let's use tailwind classes for the gradient to be responsive to dark mode.
        */
        }
    </div>

    {
        /* Since inline style variable is tricky with dark mode, let's use Tailwind's `from-white via-white to-transparent` */
    }
    <div
        class="absolute inset-0 z-0 pointer-events-none bg-gradient-to-r from-white via-white/100 to-transparent dark:from-black dark:via-black/90 dark:to-transparent w-[90%] md:w-[80%]"
    >
    </div>

    {/* Layer 3: Content (Left Side) */}
    <article class="relative z-10 flex flex-col justify-center h-full p-6 sm:p-8 w-full sm:w-[65%]">
        {/* Date / Meta */}
        <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 mb-3 font-mono">
            <FormattedDate date={date} />
        </div>

        {/* Title */}
        <h2
            class="text-2xl font-bold text-gray-900 dark:text-white mb-3 leading-tight group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"
        >
            <a href={url} class="block">
                {title}
            </a>
        </h2>

        {/* Excerpt */}
        {
            Astro.slots.default && (
                <p class="text-gray-600 dark:text-gray-400 mb-6 line-clamp-2 leading-relaxed">
                    <slot />
                </p>
            )
        }

        {/* Tags (Solid Pill Style) */}
        {
            tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mt-auto">
                    {tags.map(tag => (
                        <TagBadge tag={tag} variant="card" />
                    ))}
                </div>
            )
        }
    </article>
</div>
