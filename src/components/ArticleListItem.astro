---
import FormattedDate from "./FormattedDate.astro";
import TagBadge from "./TagBadge.astro";
import { getReadingTime } from "../utils/readingTime";

interface Props {
    title: string;
    url: string;
    date: Date;
    tags?: string[];
    heroImage?: string;
    body?: string;
}

const { title, url, date, tags = [], heroImage, body } = Astro.props;
const readingTime = getReadingTime(body);
---

<div
    class="group relative rounded-2xl overflow-hidden bg-white dark:bg-[#18181b] border border-zinc-200 dark:border-zinc-800 shadow-sm dark:shadow-none hover:shadow-xl dark:hover:shadow-none transition-all duration-300 h-48 lg:h-64"
>
    {/* Layer 1: Image (Right Side, 3/5 width) with Mask for Fade */}
    {
        heroImage && (
            <div
                class="absolute top-0 bottom-0 right-0 w-[65%] z-0 transition-transform duration-700 group-hover:scale-105"
                style="-webkit-mask-image: linear-gradient(to right, transparent 0%, transparent 10%, black 50%, black 100%); mask-image: linear-gradient(to right, transparent 0%, transparent 10%, black 50%, black 100%);"
            >
                <img src={heroImage} alt="" class="w-full h-full object-cover object-center" />
            </div>
        )
    }

    {/* Layer 2: Removed explicit gradient overlay in favor of CSS mask on image for cleaner blend */}

    {/* Layer 3: Relaxed Content Overlay */}
    <article class="relative z-10 flex flex-col justify-center h-full p-5 pr-5 lg:p-8 lg:pr-0 w-full lg:w-[55%]">
        {/* Title */}
        <h2
            class="text-lg lg:text-3xl font-bold text-gray-900 dark:text-white mb-2 leading-tight lg:leading-relaxed group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors drop-shadow-md"
        >
            <a href={url} class="block">
                {title}
            </a>
        </h2>

        {/* Date / Meta */}
        <div
            class="flex items-center gap-2 lg:gap-3 text-xs lg:text-2xl text-gray-600 dark:text-gray-400 mb-3 mt-1 font-mono drop-shadow-sm"
        >
            <FormattedDate date={date} />
            <div class="flex items-center gap-1 ml-2">
                <svg
                    class="w-4 h-4 lg:w-7 lg:h-7"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>{readingTime}</span>
            </div>
        </div>

        {/* Excerpt - Optional, user implied focusing on Title/Image, but kept strictly if slot exists. */}
        {
            Astro.slots.default && (
                <p class="text-gray-600 dark:text-gray-300 mb-6 line-clamp-2 leading-relaxed max-w-[85%] drop-shadow-sm">
                    <slot />
                </p>
            )
        }

        {/* Tags (Solid Pill Style) */}
        {
            tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mt-2 lg:mt-auto">
                    {tags.map(tag => (
                        <TagBadge tag={tag} variant="card" />
                    ))}
                </div>
            )
        }
    </article>
</div>
